<!DOCTYPE html>
<html lang="ru">
  <head>
    <title>Verge3D Physics Guide - Soft8Soft</title>
    <meta charset="utf-8">
    <meta name="description" content="How to use Verge3D physics engine to simulate dynamics and collisions on your scene."/>
    <base href="../../../" />
    <script src="page.js"></script>
    <link type="text/css" rel="stylesheet" href="page.css" />
  </head>
  <body><article>

    <h1>Руководство по физике Verge3D</h1>

    <p>В Verge3D присутствует физический движок, который может заставить ваши 3D-объекты вести себя как в реальном мире. Эта функция особенно полезна для создания 3D-игр и AR/VR-приложений.</p>

    <iframe class="video-480p" src="https://www.youtube.com/embed/RZnFcIXo0Ws" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

    <p></p>

    <p>В качестве физического бэкенда мы используем физический движок Bullet с открытым исходным кодом, веб-версия которого называется <a href="https://github.com/kripken/ammo.js" target="_blank">Ammo.js</a>.</p>

    <h2>Содержание</h2>

    [contents]


    [anchor:getting_started_with_physics]

    <h2>Начиная Работу с Физикой</h2>

    <p>Прежде чем вы сможете использовать физику, необходимо добавить модуль физики в ваше приложение. Это можно сделать на этапе создания приложения с помощью соответствующей опции в App Manager.</p>

    <img src="files/physics-guide/app-manager-physics.jpg" class="centered" style="max-width: 574px">

    <p class="note">
      По умолчанию Verge3D использует так называемую WebAssembly-версию физического движка. Эта версия дает значительный прирост производительности по сравнению с обычной версией, но не работает в Internet Explorer 11 и старых браузерах Safari (версии 10 или ниже). Если вам нужно, чтобы ваше приложение поддерживалось в этих браузерах, включите модули *Physics* и *IE 11* в диалоге создания приложения.
    </p>

    <p>Кроме того, вы можете добавить модуль физики в уже существующее приложение. Для этого скопируйте файлы *ammo.wasm.js* и *ammo.wasm.wasm* из папки *verge3d/build* в папку вашего приложения, и добавьте строку</p>

    <code>
    &lt;script src="ammo.wasm.js"&gt;&lt;/script&gt;
    </code>

    <p>в файл <strong>.html</strong> вашего приложения над скриптом *v3d.js* .</p>


    [anchor:using_puzzles]

    <h2>Использование Пазлов</h2>

    <p>Ознакомьтесь с <a href="manual/ru/puzzles/Physics.html">пазлами физики</a>.</p>


    [anchor:general_recommendations]

    <h2>Общие Рекомендации</h2>

    <ul>
      <li>
        Обязательно применяйте масштаб в пакете моделирования, так как физический движок просто игнорирует масштаб объектов.
      </li>
      <li>
        Для достижения наилучших результатов начало координат вашего объекта должно совпадать с центром массы. Чтобы сделать это в Blender 2.8, используйте оператор <strong>Object > Set Origin > Origin to Center of Mass (Volume)</strong>.
      </li>
      <li>
        Никогда не позиционируйте и не анимируйте <em>динамическое</em> тело напрямую. Вместо этого применяйте к нему силу/импульс/скорость используя пазл <a href="manual/ru/puzzles/Physics.html#apply_vector">apply vector</a> или прикрепите его к другому объекту пазлом <a href="manual/ru/puzzles/Physics.html#snap_body">snap body</a> .
      </li>
      <li>
        В целях оптимизации, Verge3D отключает <em>динамические</em> тела после периода бездействия. Вы можете активировать эти тела снова, применив какой-либо вектор, столкнув их с другими телами или используя опцию *activate* пазла <a href="manual/ru/puzzles/Physics.html#set_body_state">set body state</a> . Если вам нужно, чтобы тело было активным постоянно, примените к нему состояние *disable deactivation* используя тот же пазл.
      </li>
      <li>
        Включить метод непрерывного обнаружения столкновений (CCD) для улучшения качества моделирования быстродвижущихся тел, таких как снаряды, шары для пинбола/бильярда/боулинга и т.д. Для этого установите параметры *ccd motion threshold* и *ccd swept sphere radius* на эти тела. См. <a href="manual/ru/puzzles/Physics.html#apply_body_param">здесь</a> для дополнительной информации.
      </li>
      <li>
         Помните, что вы не можете <a href="manual/ru/puzzles/Physics.html#detect_collisions">определить коллизию</a> между  *static*/*static*, *static*/*kinematic*, или *kinematic*/*kinematic* объектами. Если использование *dynamic* тела не представляется возможным, рассмотрите возможность назначения *ghost* физики для реализации обнаружения движущегося рядом нединамического объекта с *static*/*kinematic* средой.
      </li>
    </ul>


    [anchor:creating_first_person_character]

    <h2>Создание персонажа от первого лица</h2>

    <p>Режим персонажа от первого лица может быть удобен не только для шутеров и RPG-игр, но и для любых приложений, требующих исследования больших пространств. Это может быть визуализация архитектуры, приложения для электронного обучения и интерактивные гиды, музеи и другие культурные объекты, и даже виртуальные 3D-рынки. Кроме того, вы можете интегрировать персонажа от первого лица в ваше VR-приложение, сделав его гораздо более реалистичным и увлекательным!</p>

    <p>Существует множество возможных способов реализации режима FPS, но для неопытных пользователей Verge3D мы рекомендуем вам следовать этому краткому руководству для более быстрого достижения результатов.</p>

    <p>Создайте объект в форме капсулы, который символизирует вашего персонажа. Настройте его высоту и ширину, чтобы он выглядел более реалистично. Убедитесь, что вы правильно установили центр объекта.</p>

    <img src="files/physics-guide/capsule-shape.jpg" class="centered" style="max-width: 639px">

    <p>В пазлах, назначьте персонажу *dynamic* *capsule* (капсулообразное) тело и отключите его вращение. Таким образом, вы позволите персонажу двигаться, но не вращаться. Также примените *disable deactivation* к вашей капсуле.</p>

    <img src="files/physics-guide/create-character-puzzles.jpg" style="max-width: 725px">

    <p>Поскольку персонажу нужен пол (+стены) или земля, чтобы ходить, создайте такие тела, используя соответствующие пазлы *create physics body*.</p>

    <p>Следующий шаг - настройка камеры. Камере не будет назначена физика, поскольку она нужна нам только для того, чтобы быть нашими "глазами". Установите на него элементы управления *First-Person*, но не назначайте материал коллизии (мы будем использовать полнофункциональное обнаружение коллизий, предоставляемое физическим движком, а не базовую симуляцию пола/стен). Также, уберите галку с параметра *Allow Panning* , а параметр *Movement Speed* поставьте на ноль:</p>

    <img src="files/physics-guide/firstperson-camera-settings.jpg" class="centered" style="max-width: 320px">

    <p>Теперь нам нужно прикрепить камеру к "голове" персонажа. Нет необходимости создавать модель головы, добавьте в сцену пустой объект под названием "Голова" и прикрепите его к верхней части модели капсулы. Таким образом, "голова" будет двигаться вместе с персонажем.</p>

    <p>С помощью дополнительного объекта "Голова" вы можете прикреплять/откреплять камеру к персонажу. Чтобы прикрепить камеру, используйте <a href="manual/ru/puzzles/Objects.html#parent">parent</a> и <a href="manual/ru/puzzles/Objects.html#snap_to_object">snap to object</a> пазлы:</p>

    <img src="files/physics-guide/snap-camera-puzzles.jpg" style="max-width: 560px">

    <p class="note">Чтобы открепить камеру, используйте пазл *parent* с пустым полем *to object* .</p>

    <p>Персонаж создан! Теперь пришло время заставить его двигаться в вашей сцене. В самом простом случае нам нужно двигаться вперед, когда пользователь нажимает клавишу со стрелкой вверх. Для этого примените к персонажу вектор *linear velocity*, который рассчитывается на основе горизонтального направления камеры. Чтобы сделать симуляцию более достоверной, всегда применяйте векторы, используя пазл <a href="manual/ru/puzzles/Physics.html#on_simulation_tick">on simulation tick</a> .</p>

    <img src="files/physics-guide/moving-character-puzzles.jpg" style="max-width: 981px">

    <p>Для перемещения персонажа на мобильном устройстве вам понадобятся дополнительные элементы "контроллера". Вы можете создать их с помощью 3D-объектов, родительских по отношению к камере или с помощью <a href="manual/ru/introduction/HTML-based-user-interfaces.html">HTML элементов</a>.</p>

    <p>Для перемещения персонажа в режиме VR вы можете использовать пазл <a href="manual/ru/puzzles/AR_VR.html#get_controller_prop">get controller property</a> и пазл <a href="manual/ru/puzzles/System.html#get_gamepad_prop">get gamepad property</a> для получения статуса кнопок/осей контроллера VR.</p>


    [anchor:simulating_car_physics]

    <h2>Симуляция физики автомобиля</h2>

    <p>
      Реалистичное симулирование физики автомобиля может быть действительно полезным в таких приложениях, как интерактивные программы настройки автомобиля или гоночные игры. Ознакомьтесь с игрой <em>Arcade Racing</em> в дистрибутиве Verge3D, чтобы понять, как реализовать эту функцию в вашем собственном приложении.
    </p>


    <h2>Остались вопросы?</h2>

    <p>Задайте их на нашем <a href="https://www.soft8soft.com/forums/" target="_blank">форуме</a>!</p>


  </article></body>
</html>
