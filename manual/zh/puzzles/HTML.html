<!DOCTYPE html>
<html lang="zh">
  <head>
    <title>HTML类拼图参考 - Soft8Soft</title>
    <meta charset="utf-8">
    <meta name="description" content="如何使用拼图来控制HTML DOM元素。"/>
    <base href="../../../" />
    <script src="page.js"></script>
    <link type="text/css" rel="stylesheet" href="page.css" />
  </head>
  <body><article>
    <h1>HTML拼图</h1>

    <p>这些拼图可以操作HTML DOM元素。</p><img src="files/puzzles/puzzles-html.jpg"><h2>内容</h2>

    [contents] [anchor:what_is_html_dom]

    <h2>什么是HTML DOM？</h2>

    <p>HTML DOM（文档对象模型，见 <a href="https://en.wikipedia.org/wiki/Document_Object_Model" target="_blank">技术文档</a>）是一个HTML页面的程序化接口。基本上，这意味着除了通过直接编辑文本代码，还可以通过执行拼图模块来修改应用。例如，您可以添加新的HTML元素来自定义页面外观、在模型上画图、屏幕截图、下载文件等。</p>

    [anchor:puzzles_reference]

    <h2>拼图参考</h2>

    [anchor:add_HTML_element]

    <h3>add HTML element(添加HTML元素)</h3>

    <p>创建一个具有指定 <a href="https://www.w3schools.com/tags/default.asp" target="_blank">类型</a> 和标识符（对应于 &quot;id &quot;属性）的HTML元素，并将其添加到指定的现有HTML元素之前或之后。</p><img src="files/puzzles/puzzles-html-add-html-elem.jpg">

    [anchor:remove_html_element]

    <h3>remove HTML element(移除HTML元素)</h3>

    <p>移除一个具有指定标识符的HTML元素。</p><img src="files/puzzles/puzzles-html-remove-html-elem.jpg">

    [anchor:get_attribute]

    <h3>get attribute(获取属性)</h3>

    <p>从一个具有指定id的HTML元素中获取一个 <a href="https://www.w3schools.com/tags/ref_attributes.asp" target="_blank">属性</a> 。 如果该HTML元素位于一个外部的HTML文档中（Verge3D应用的 <strong>.html</strong> 文件通过 <strong>iframe</strong>嵌入其中），应启用 &quot;in parent doc&quot; 复选框。</p><img src="files/puzzles/puzzles-html-get-attr.jpg">

    [anchor:set_attribute]

    <h3>set attribute(设置属性)</h3>

    <p>为一个具有指定id的HTML元素设置一个 <a href="https://www.w3schools.com/tags/ref_attributes.asp" target="_blank">属性</a> 。 如果该HTML元素位于一个外部HTML文档中（Verge3D应用的 <strong>.html</strong> 文件通过 <strong>iframe</strong>嵌入其中），应启用 &quot;in parent doc&quot; 复选框。也适用于元素ID的列表。</p><img src="files/puzzles/puzzles-html-set-attr.jpg">

    [anchor:create_css_rule]

    <h3>create css rule(创建css规则)</h3>

    <p>创建一个新的 <a href="https://www.w3schools.com/css/css_syntax.asp" target="_blank">CSS规则</a>。如果样式表属于外部HTML文档（Verge3D应用的 <strong>.html</strong> 文件通过 <strong>iframe</strong>嵌入其中），应启用 &quot;in parent doc&quot; 复选框。</p><img src="files/puzzles/puzzles-html-create-css-rule.jpg">

    [anchor:set_style]

    <h3>set style(设置样式)</h3>

    <p>为具有指定id的HTML元素设置一个 <a href="https://www.w3schools.com/cssref/default.asp" target="_blank">CSS属性</a> 。 如果HTML元素位于一个外部的HTML文档中（Verge3D应用的 <strong>.html</strong> 文件通过 <strong>iframe</strong> 嵌入其中），应启用 &quot;in parent doc&quot; 复选框。也适用于元素ID的列表。</p><img src="files/puzzles/puzzles-html-set-style.jpg">

    [anchor:get_style]

    <h3>get style(获取样式)</h3>

    <p>从指定id的HTML元素获取一个 <a href="https://www.w3schools.com/cssref/default.asp" target="_blank">CSS属性</a> 。 如果HTML元素位于一个外部的HTML文档中（Verge3D应用的 <strong>.html</strong> 文件通过 <strong>iframe</strong> 嵌入其中），应启用 &quot;in parent doc&quot; 复选框。</p><img src="files/puzzles/puzzles-html-get-style.jpg"><p>这个拼图在制作3D配置器类应用时非常有用。例如，你可以使用下面的设置，从一些HTML元素的背景颜色中指定材质颜色：</p><img src="files/puzzles/puzzles-html-get-style-example.jpg">

    [anchor:set_css_rule]

    <h3>set css rule(设置css规则)</h3>

    <p>为指定的CSS规则（可在应用的 <strong>.css</strong> 文件中找到）设置一个 <a href="https://www.w3schools.com/cssref/default.asp" target="_blank">CSS属性</a> 。如果样式表属于外部HTML文档（Verge3D应用的 <strong>.html</strong> 文件通过 <strong>iframe</strong>嵌入其中），应启用 &quot;in parent doc&quot; 复选框。</p><img src="files/puzzles/puzzles-html-set-css-rule.jpg">

    [anchor:event]

    <h3>event(事件)</h3>

    <p>为一个具有指定id的HTML元素注册一个 <a href="https://www.w3schools.com/jsref/dom_obj_event.asp" target="_blank">事件监听器</a> 。 如果该HTML元素位于一个外部的HTML文档中（Verge3D应用的 <strong>.html</strong> 文件通过 <strong>iframe</strong>嵌入其中），应启用 &quot;in parent doc&quot; 复选框。一旦有事件发生，放在 &quot;do&rdquo; 插槽中的对象就会被触发。也适用于元素ID的列表。</p><img src="files/puzzles/puzzles-html-on-event.jpg">

    [anchor:get_event_property]

    <h3>get event property(获取事件属性)</h3>

    <p>输出由 &quot;event(事件)&quot; 拼图产生的事件 <a href="https://www.w3schools.com/jsref/obj_events.asp" target="_blank">属性</a> 值。</p><img src="files/puzzles/puzzles-html-get-event-property.jpg">

    [anchor:DOM_object_selector] <!--COMPAT--><p><a href="manual/zh/puzzles/HTML.html#window" id="window" class="permalink"></a></p>
    <p><a href="manual/zh/puzzles/HTML.html#document" id="document" class="permalink"></a></p>
    <p><a href="manual/zh/puzzles/HTML.html#body" id="body" class="permalink"></a></p>

    <h3>DOM object selector(DOM对象选择器)</h3>

    <p>*container*代表画布容器元素&mdash;&mdash;包含渲染场景的HTML元素；*window*代表 <a href="https://www.w3schools.com/jsref/obj_window.asp" target="_blank">DOM窗口对象</a> &mdash;&mdash;浏览器标签或加载HTML文档的iframe；*document*代表 <a href="https://www.w3schools.com/jsref/dom_obj_document.asp" target="_blank">DOM文档对象</a> &mdash;&mdash;HTML文档的根节点；*body*代表 <a href="https://www.w3schools.com/jsref/dom_obj_body.asp" target="_blank">DOM主体对象</a> &mdash;&mdash;HTML文档的&lt;body&gt;元素。</p><img src="files/puzzles/puzzles-html-DOM-object-selector.jpg">

    [anchor:query_selector]

    <h3>query selector(查询选择器)</h3>

    <p>返回第一个符合指定的 <a href="https://www.w3schools.com/cssref/css_selectors.asp" target="_blank">CSS选择器</a>的HTML元素。</p><img src="files/puzzles/puzzles-html-query-selector.jpg">

    [anchor:create_canvas_elem]

    <h3>create canvas elem(创建canvas元素)</h3>

    <p>创建一个具有*id*、*width*和*height*属性的canvas元素。将此对象与 <a href="manual/zh/puzzles/Materials.html#replace_texture">replace texture(替换纹理)</a> 拼图一起使用，可用于创建画布纹理。</p><img src="files/puzzles/puzzles-html-create-canvas-elem.jpg"><p>画布创建完成后，即可通过JavaScript在上面绘图了。您可以在 <em>your_app_name.js</em> 模块的 <em>runCode()</em> 函数中更新画布，或者使用 <a href="manual/zh/puzzles/Advanced.html#exec_script">exec script(执行脚本)</a> 拼图。</p>

    <p>要更新画布，可通过ID（指定的*id*属性）检索画布纹理。</p>
    </p>
    
    
<code>

    var canvasTex = v3d.puzzles.canvasTextures['my_canvas'];
    
</code>

    
    <p>之后，您可以按以下方式访问HTML画布元素：</p>
    
    
<code>

    var canvas = canvasTex.image;
    
</code>

    
    <p>您可以使用可用于在HTML画布上绘图的标准方法。例如，下方代码在白色背景上绘制了一张蓝色的笑脸：</p>
    
    
<code>

      var ctx = canvas.getContext("2d");
  
      ctx.fillStyle = 'white';
      ctx.strokeStyle = 'blue';
  
      ctx.fillRect(0, 0, canvas.width, canvas.height);
  
      ctx.beginPath();
      ctx.arc(75, 75, 50, 0, Math.PI * 2, true); // Outer circle
      ctx.moveTo(110, 75);
      ctx.arc(75, 75, 35, 0, Math.PI, false);  // Mouth (clockwise)
      ctx.moveTo(65, 65);
      ctx.arc(60, 65, 5, 0, Math.PI * 2, true);  // Left eye
      ctx.moveTo(95, 65);
      ctx.arc(90, 65, 5, 0, Math.PI * 2, true);  // Right eye
      ctx.stroke();
  
      
</code>

    
    <p>最后，如果您想让更新在3D渲染中立即可见需将画布纹理标记为动态。</p>
    
    
<code>

    canvasTex.needsUpdate = true;
    
</code>

    
    <img src="files/puzzles/puzzles-html-create-canvas-elem-example.jpg">

    [anchor:draw_line]

    <h3>draw line(画线)</h3>

    <p>通过一个动态更新的线条将指定的3D对象与指定的HTML元素连接起来。如果HTML元素位于一个外部HTML文档中（Verge3D应用的 <strong>.html</strong> 文件通过 <strong>iframe</strong>) 嵌入其中），应启用 &quot;in parent doc&quot; 复选框。您也可以为该行设置宽度、颜色和偏移。</p><img src="files/puzzles/puzzles-html-draw-line.jpg">

    [anchor:remove_line]

    <h3>remove line(移除线)</h3>

    <p>从指定的对象中移除一条先前创建的线。</p><img src="files/puzzles/puzzles-html-remove-line.jpg">

    [anchor:bind_element]

    <h3>bind element(绑定元素)</h3>

    <p>使一个指定的HTML元素在屏幕空间中跟随一个指定的3D对象的中心。如果HTML元素位于一个外部HTML文档中（Verge3D应用的 <strong>.html</strong> 文件通过 <strong>iframe</strong>) 嵌入其中），应启用 &quot;in parent doc&quot; 复选框。</p><img src="files/puzzles/puzzles-html-bind-element.jpg"><p>*注意*：</p>

    <p>您可以使用 <a href="manual/zh/puzzles/Objects.html#add_annotation">add annotation(添加标注)</a> 拼图来代替，并参照 <a href="manual/zh/introduction/Styling-Verge3D-Apps.html#Annotations" target="_parent">这里</a>的描述定制标注的外观。</p>

    [anchor:init_fullscreen]

    <h3>init fullscreen(初始化全屏)</h3>

    <p>设置一个指定的HTML元素为全屏模式按钮&mdash;&mdash;第一次点击进入全屏模式，第二次点击退出全屏。放在 &quot;on enter do&quot; 和 &quot;on exit do&quot; 插槽里的对象会在进入或退出全屏模式时被触发。如果浏览器不支持全屏，放在 &quot;if unavailable do&quot; 插槽中的对象会被触发（例如在iOS Safari中）。</p><img src="files/puzzles/puzzles-html-init-fullscreen.jpg">

    [anchor:open_web_page]

    <h3>open web page(打开网页)</h3>

    <p>当此拼图被触发时，根据下拉选择，一个指定的URL会在一个新的或同一浏览器标签内打开。当从拼图编辑器中触发时，跳出当前页面前会弹出确认提示。</p><img src="files/puzzles/puzzles-html-open-web-page.jpg">

    [anchor:social_share_link]

    <h3>social share link(社交网站分享链接)</h3>

    <p>生成一个链接，以便在主流社交媒体上分享你的应用。</p><img src="files/puzzles/puzzles-html-social-share-link.jpg">

    [anchor:set_url_param]

    <h3>set URL param(设置URL参数)</h3>

    <p>如有必要，可通过自动形成一个有效的 <a href="https://en.wikipedia.org/wiki/Query_string" target="_blank">查询字符串</a> 来分配或更新指定URL中的参数值，并返回更新的URL。</p><img src="files/puzzles/puzzles-html-set-url-param.jpg"><p>当一个应用的配置数据被存储在其URL中时，此对象会很有用。例如，您可以通过以下方式指定一张图片作为纹理使用：</p>

    <pre class="prettyprint"><code class="language-html">https://www.example.com/my_awesome_app.html?image_url=https://www.uploadserver.com/path/to/image.jpg
</code>
</pre>

    <p>上传一个纹理，检索其服务器端的路径，并将其保存到应用URL的 *image_url* 参数中，如下所示：</p><img src="files/puzzles/puzzles-html-set-url-param-example.jpg"><p>请参阅Verge3D发行版中的 *Custom Image* 演示案例，了解其完整的工作方式。</p>

    [anchor:take_screenshot]

    <h3>take screenshot(截屏)</h3>

    <p>获取视口的截图并以 <a href="manual/zh/puzzles/HTML.html#data_uri">数据URI</a> 格式输出。</p><img src="files/puzzles/puzzles-html-take-screenshot.jpg"><p>*注意*：</p>

    <p>您需要使用 <a href="manual/zh/puzzles/Initialization.html#configure_application">configure application(配置应用)</a> 拼图为应用启用屏幕截图，否则将会生成全黑的图像。</p>

    [anchor:get_url_data]

    <h3>get URL data(获取URL数据)</h3>

    <p>检索应用被加载到的窗口的URL数据。</p>

    <p>
    <ul>
    <li>*Entire URL* - 文本，例如： &quot;https://www.example.com/my_awesome_app.html?image_url=https://www.uploadserver.com/path/to/image.jpg&quot;</li>
    <li>*Parameters* - 字典，例如： {&quot;image_url&quot;: &quot;https://www.uploadserver.com/path/to/image.jpg&quot;}</li>
    <li>*Host name* - 文本，例如： &quot;www.example.com&quot;</li>
    </ul>如果需要获取外部HTML文档的窗口（Verge3D应用的 <strong>.html</strong> 文件通过 <strong>iframe</strong> 嵌入其中），应启用 &quot;in parent doc&quot; 复选框。</p><img src="files/puzzles/puzzles-html-get-url-data.jpg"><p>当一个应用的配置数据被存储在其URL中时，此对象会很有用。例如，您可以通过以下方式指定一张图片作为纹理使用：</p>

    <pre class="prettyprint"><code class="language-html">
      https://www.example.com/my_awesome_app.html?image_url=https://www.uploadserver.com/path/to/image.jpg
      
</code>
</pre>

    <p>然后您可以检索 *image_url* 参数，加载并应用该纹理，方法如下。</p><img src="files/puzzles/puzzles-html-get-url-data-example.jpg"><p>请参阅Verge3D发行版中的 *Custom Image* 演示案例，了解其完整的工作方式。</p>

    [anchor:download_file]

    <h3>download file(下载文件)</h3>

    <p>下载以 <a href="manual/zh/puzzles/HTML.html#data_uri">数据URI</a> 格式指定的内容到一个文件中。您也可以传递文本、 <a href="manual/zh/puzzles/Dictionaries.html">字典</a>、或 <a href="manual/zh/puzzles/Lists.html">列表</a> 数据，作为文本或JSON文件下载。在这种情况下，给定的对象将被自动转换为适当的数据URI。</p><img src="files/puzzles/puzzles-html-download-file.jpg"><p>此拼图可用于以下情境：</p>

    <ul>
      <li>保存屏幕截图</li>
      <li>通过保存字典（或列表）到 <strong>*.json</strong> 文件来保存应用状态</li>
      <li>以glTF格式导出模型，以便进一步处理</li>
      <li>生成文本式的价格信息、报价、报告等。</li>
    </ul><img src="files/puzzles/puzzles-html-download-file-example.jpg">

    [anchor:open_file]

    <h3>open file and opened file(打开文件和已打开的文件)</h3>

    <p>调用浏览器的本地对话窗口，从用户的设备中选择文件。当用户选择了文件后，以 <a href="manual/zh/puzzles/HTML.html#data_uri">数据URI</a> 格式返回文件的内容。</p><img src="files/puzzles/puzzles-html-open-file.jpg">

    [anchor:drop_file_to]

    <h3>drop file to(将文件拖到)</h3>

    <p>返回一个从文件管理器（或其他程序）拖拽的文件，并将其放置在浏览器窗口内给定的HTML元素上。当用户拖放该文件后，将其内容作为 <a href="manual/zh/puzzles/HTML.html#open_file">opened file(打开的文件)</a> 拼图返回（使用 <a href="manual/zh/puzzles/HTML.html#data_uri">数据URI</a> 格式）。</p><img src="files/puzzles/puzzles-html-drop-file-to.jpg"><p>您可以激活可选的 *drag over* 插槽来处理文件移动事件。例如，您可以将其与 <a href="manual/zh/puzzles/Scenes.html#raycast">raycast(射线)</a> 拼图一起使用，以突出光标或触摸点下方的对象。</p>

    [anchor:data_uri]

    <h2>Data URI Links(数据URI链接)</h2>

    <p>数据URI（或数据URL）是一种方便的方法，可以嵌入各种资产，如图片、glTF模型、声音、JSON或CSV的链接（<a href="https://en.wikipedia.org/wiki/Data_URI_scheme" target="_blank">技术资料</a>）。</p>

    <p>例如，下面的链接代表了Verge3D的logo：</p><code class="language-html">data:image/png;base64, iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAABGdBTUEAALGPC/xhBQAAACBjSFJN AAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAABvFBMVEUAAAAASKUAAFsAvukA RaMA3voAAEoARaQARKMARqQARqQARKMARaQARqQAQ6IATagCcLwCcbwATagARqQASaYARqQASKUC argASKUARqQASqYASKUAR6QAT6kAT6kAR6QAR6UASaUASaUAR6UARKMBWq8BWq8ARKMAQqECaLcC abgAQqEAQaECbboCbroAQaECbrsCbroCabcCa7kCb7sCbrsARaQARaQElNAEldEGrd4GseEDg8cD hcgGtOIGrt8Eks8I1/cFqNwBUqsAQ6IBVKwGrN4Ekc8El9IJ5/8HvOcBU6sASqYDdb8CdL4ASaYB VawHv+gJ5/4EltII0PIJ4PsCc70ARqQEjs0J4vwJ4fsEi8sARaMDdr8J4fwI0fIJ3/sGuuYATKcC ZbYI1fUHyfMHyPMI0/QCYrQATagHvecJ4PwEj80ARKMFnNQHyvMBU8IBUsEFmNII3PkHwuoIyvQH vugAS6cDecEI1/YCbrsBWK4I0vMJ5v8HyPIIz/ICcr0I2PcIz/EDgMUBXrEJ6P8I1vYBW7ADhMcC cb0Hv+kFmNMEkM4GueUJ4PoJ3/oJ3voI3foEltH///+98SuhAAAAOHRSTlMAAAAAAAAAJJPu8Jgn EWjT/v7VEAVLvvq8RwQFe/LweDXn6DdT9/hXWvn6XVv5+lz6+fn6/v7w7sPq7QcAAAABYktHRJPh A9+2AAAACXBIWXMAAA3XAAAN1wFCKJt4AAAAB3RJTUUH4QsCEC4OPIwcRgAAAQpJREFUGNNjYGBg YGRi5+Dk4uZhZmQAAUYWXj5+AQtLQSE+YRagEKOIqJi4lbWNrZ29uISkFCODtIysg6OTs4uLq5uj u5y8NIOCooenl7ePr59/QGBQsJIyg4pqSGhYeERkVHRMbFy8mjqDhmZCYlJySmpaekZmVoKWNoOO bnZObl5+QWFqUa5DnJ4+g75BsW9SSWlBQX5ZeUWxoQ6DtnhlVXVNbVpdbX1AQ6ORBoO6WlNzS6Nn a6tnW3tHk6oKg7JSkVdYpWdtrWdKZ1e3ogKDtLxcT28fSKA/0UFWRpqBUUpSwth+QmvrRHtjMVER kGdYhPmETCZZmvLz8bJA/cvKw21mzsHOBuICAHx4PYwwa1fDAAAAJXRFWHRkYXRlOmNyZWF0ZQAy MDE3LTExLTAyVDE2OjQ2OjE0KzAxOjAwKvGBdAAAACV0RVh0ZGF0ZTptb2RpZnkAMjAxNy0xMS0w MlQxNjo0NjoxNCswMTowMFusOcgAAAAZdEVYdFNvZnR3YXJlAHd3dy5pbmtzY2FwZS5vcmeb7jwa AAAAV3pUWHRSYXcgcHJvZmlsZSB0eXBlIGlwdGMAAHic4/IMCHFWKCjKT8vMSeVSAAMjCy5jCxMj E0uTFAMTIESANMNkAyOzVCDL2NTIxMzEHMQHy4BIoEouAOoXEXTyQjWVAAAAAElFTkSuQmCC
</code>
<p>复制整个片段并粘贴到浏览器地址栏打开即可显示该标志。</p><img src="files/puzzles/data-url-logo.jpg"><p>在拼图中，我们广泛使用数据URI链接，因为它们提供了在不同拼图块之间传递类似于文件的数据的便捷方式。例如，您可以使用 <a href="manual/zh/puzzles/HTML.html#open_file">open file(打开文件)</a> 或 <a href="manual/zh/puzzles/HTML.html#drop_file_to">drag file to(将文件拖到)</a> 拼图加载文件（图像或数据）。然后您可以根据该文件对您的场景进行修改。之后，您可以通过 <a href="manual/zh/puzzles/HTML.html#download_file">download file(下载文件)</a>拼图将修改后的场景（或数据，比如价格表文件）上传到用户机器上，或通过 <a href="manual/zh/puzzles/Advanced.html#send_data">send data(发送数据)</a> 拼图将该文件上传到服务器。在所有这些情况中，数据都将使用数据URI格式传输。</p>

    <p class="note">请参阅Verge3D发行版中的 *Custom Image* 演示案例，了解数据URI的使用方法。</p>

    <p>调试Data URI格式的数据也很容易。只需使用 <a href="manual/zh/puzzles/System.html#print_to_console">print to console(打印到控制台)</a> 拼图，然后打开 <a href="manual/zh/introduction/FAQ.html#browser_console">browser console(浏览器控制台)</a> 来观察输出，然后点击控制台内打印的URI，在单独的浏览器标签中预览数据。</p><img src="files/puzzles/data-url-debugging.jpg"><h2>在使用拼图时遇到困难？</h2>

    <p>欢迎您随时在 <a href="https://www.soft8soft.com/forums/" target="_blank">论坛</a>上提问！您还可以加入中文用户社区<a href="https://shang.qq.com/wpa/qunwpa?idkey=c31cf6597f3ed7ce68bd47aba6bba23049bf973ac6acc59b0a5a7d1bd933b3ea" target="_blank">QQ群(171678760)</a>，在线寻求帮助。</p>

  </article></body>
</html>
